# API Scraper Mailer

Este projeto √© uma API respons√°vel por realizar scraping de dados de diferentes fontes e enviar e-mails com as informa√ß√µes coletadas. Ele utiliza **Node.js** com **TypeScript** e **Prisma** para comunica√ß√£o com o banco de dados.

## Funcionalidades

- Realiza scraping de dados de diversas fontes (Ex√©rcito, Di√°rio Oficial, etc.).
- Envia e-mails com os dados extra√≠dos.
- Suporte para CRUD de usu√°rios.
- Persiste dados em banco de dados serverless PostgreSQL.

## Tecnologias

- **Node.js**
- **TypeScript**
- **Prisma ORM**
- **PostgreSQL**
- **Nodemailer** (para envio de e-mails)
- **Node Cron** (para agendamento de tarefas)
- **GitHub Actions** (para CI/CD)

## Arquitetura

O sistema √© organizado de acordo com a **Clean Architecture**. Aqui est√£o as principais camadas do sistema:

- **Controllers**: Respons√°veis por lidar com as requisi√ß√µes HTTP e delegar o processamento para os servi√ßos.
- **Services (Usecases)**: Cont√™m a l√≥gica de neg√≥cio, realizando as opera√ß√µes principais do sistema.
- **Domain**: Cont√©m entidades e reposit√≥rios que abstraem a persist√™ncia de dados.
- **Infrastructure**: Respons√°vel por integrar com tecnologias externas, como APIs, bancos de dados e envio de e-mails.

## Main - Ponto de Entrada da Aplica√ß√£o

A camada **main** √© respons√°vel por:

- Inicializar o servidor e configurar as rotas.
- Definir os cron jobs agendados.
- Orquestrar a execu√ß√£o de componentes como a configura√ß√£o do banco de dados, envio de e-mails, e scraping de dados.
  
## üîß Instala√ß√£o

Para configurar o projeto localmente, siga os passos abaixo:

1. Clone o reposit√≥rio

```bash
git clone https://github.com/seu-usuario/api-scraper-mailer.git
cd api-scraper-mailer
```

### 2. Instale as depend√™ncias

```bash
npm install
```

### 3. Configure o banco de dados

Certifique-se de ter o PostgreSQL instalado e configurado localmente ou use um servi√ßo como o Neon Tech para banco de dados. Depois, crie um arquivo .env na raiz do projeto com as vari√°veis de ambiente necess√°rias.

Exemplo do .env:
```bash
DATABASE_URL="postgresql://user:password@localhost:5432/dbname?schema=public"

```

### 4. Execute as migrations do Prisma 
## Obs: se for localmente

```bash
npx prisma generate
npx prisma migrate deploy
```

### 5. Rodando o servidor

```bash
npm run dev
```
Isso vai iniciar a aplica√ß√£o em modo de desenvolvimento e o nodemon vai reiniciar o servidor sempre que voc√™ fizer altera√ß√µes nos arquivos.

### 6. Rodando o cron job (agendador de tarefas)
O agendador de tarefas do projeto est√° configurado utilizando Node Cron. Ele pode ser executado separadamente ou como parte do servidor principal.

## Vari√°veis de Ambiente

O projeto depende das seguintes vari√°veis de ambiente:

DATABASE_URL: URL de conex√£o com o banco de dados PostgreSQL.

MAIL_HOST: Host do servidor de e-mail (ex: SMTP).

MAIL_PORT: Porta do servidor de e-mail.

MAIL_USER: Usu√°rio para autentica√ß√£o no servidor de e-mail.

MAIL_PASS: Senha para autentica√ß√£o no servidor de e-mail.

**Exemplo .env:**

```bash
DATABASE_URL="postgresql://user:password@localhost:5432/dbname?schema=public"
MAIL_HOST="smtp.mailtrap.io"
MAIL_PORT=587
MAIL_USER="user"
MAIL_PASS="password"
PORT_SERVER=1000
```

### Contribuindo

```bash
Fa√ßa um fork deste reposit√≥rio.

Crie uma branch (git checkout -b feature/nome-da-feature).

Fa√ßa suas altera√ß√µes e commite (git commit -am 'Adiciona nova feature').

Envie para o reposit√≥rio remoto (git push origin feature/nome-da-feature).

Abra um Pull Request.
```

## üìö Documenta√ß√£o

Para mais detalhes sobre a arquitetura, API e outras configura√ß√µes, consulte a documenta√ß√£o na pasta [documentacao](./src/docs).
