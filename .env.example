# Copie este arquivo para .env e ajuste os valores.
# Exemplo:
#   cp .env.example .env
#
# Prisma carrega variáveis via `prisma.config.ts` (importa `dotenv/config`).

NODE_ENV=development
PORT=3000

# PostgreSQL Prod
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres

DATABASE_URL="postgresql://postgres:postgres@localhost:5432/postgres"

# JWT (obrigatório)
KEY_JWT="troque-esta-chave-por-um-segredo-forte"
# Pode ser número (segundos) ou string no formato do pacote `ms`, ex: 3600, 1d, 2h, 15m
JWT_EXPIRES_IN="1d"

JWT_ISSUER="clean-arch-backend"
JWT_AUDIENCE="clean-arch-backend"

# CORS (obrigatório para subir o app)
# Pode ser uma origem única (string) ou múltiplas separadas por vírgula
CORS_ORIGIN="http://localhost:3000"

# Sentry / GlitchTip (opcional)
SENTRY_DSN=""
# 0 a 1
SENTRY_TRACES_SAMPLE_RATE=0

# Se estiver atrás de proxy (NGINX, Cloudflare, etc), ajuste conforme seu ambiente
# Exemplos: 0, 1, 2, true, loopback (Express aceita vários formatos)
TRUST_PROXY="0"

COOKIE_SAMESITE="lax"   # lax | strict | none
COOKIE_SECURE="false"   # true em produção (HTTPS), obrigatório se SameSite=none

CSRF_ENABLED="true"     # recomendado quando usar auth via cookie (protege POST/PUT/PATCH/DELETE)
CSRF_COOKIE_NAME="csrfToken"

# Development-only debug routes (ex: /api/debug-sentry)
DEBUG_ROUTES_ENABLED="false"

# Password reset
# URL base do frontend (onde existe a tela de redefinição)
FRONTEND_URL="http://localhost:3001"
# Caminho (pode usar {token})
PASSWORD_RESET_PATH="/reset-password/{token}"
# Tempo de expiração do token (minutos)
PASSWORD_RESET_TOKEN_TTL_MINUTES=15

# Seed (admin)
# Em produção, defina esses valores antes de rodar o seed.
SEED_ADMIN_EMAIL="admin@local.test"
SEED_ADMIN_PASSWORD="ChangeMe!123"
SEED_ADMIN_NAME="Admin"

# SMTP (se for usar envio de e-mail com Nodemailer)
SMTP_HOST=""
SMTP_PORT=465
SMTP_SECURE=""   # true | false (se vazio, infere pela porta: 465=true)
SMTP_USER=""
SMTP_PASSWORD=""
EMAIL_FROM=""  # ex: "no-reply@seu-dominio.com"
# Diogrande (TLS/HTTP) - usado pelo use case de Diários Oficiais
# Em produção, prefira pin (DIOGRANDE_CA_PEM) ou gerar o PEM em ambiente controlado.
DIOGRANDE_HOST="diogrande.campogrande.ms.gov.br"
DIOGRANDE_PORT=443
DIOGRANDE_BASE_URL="https://diogrande.campogrande.ms.gov.br/wp-admin/admin-ajax.php"
DIOGRANDE_DEBUG="false"

# Último recurso (inseguro). Se true, aceita qualquer certificado.
DIOGRANDE_ALLOW_INSECURE_TLS="false"

# Defaults variam com NODE_ENV (em prod: false). Para habilitar em produção, defina explicitamente como true.
DIOGRANDE_AUTO_DISCOVER_CA=""
DIOGRANDE_CACHE_DISCOVERED_CA=""

# CA pinada (PEM). Se for multi-linha, use \n (será convertido para \n real internamente).
DIOGRANDE_CA_PEM=""

# Cache do PEM descoberto automaticamente.
DIOGRANDE_CA_CACHE_PATH="certs/diogrande-ca.pem"

# Timeouts (ms)
DIOGRANDE_DISCOVER_TIMEOUT_MS=6000
DIOGRANDE_AIA_FETCH_TIMEOUT_MS=6000

# Lista (separada por vírgula) de hosts permitidos para AIA (fetch de intermediários)
DIOGRANDE_AIA_ALLOWED_HOSTS=""

# Official Journals
OFFICIAL_JOURNALS_MAX_RANGE_DAYS=365
OFFICIAL_JOURNALS_DEBUG="false"
